---
title: Анализ работы
---



```{r,  echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(dplyr)
library(readxl)


class <- read_xlsx("data/Classess_2020.xlsx", sheet = "Sheet1", col_names = T)
class <- class %>% filter(!is.na(Login)|!is.na(Group) )
class <- class[, 1:7]


# class[class$Login == "st092164", ]


# class[is.na(class$St_Mail),]
```



# **Анализ тестов по материалам лекций**

```{r,  echo=FALSE, message=FALSE, warning=FALSE}

credits <- class %>% select(Login, St_Mail)

# credits[credits$Login == "st092164", ]


#Тест по Лекции 1
# test_lecture_1 <- read.csv("data/Оценки класса Общая экология — 30.09.2020, 8-08.csv")
# test_lecture_1 <- test_lecture_1 %>% select(3:4)

test_lecture_1 <- read_xlsx("data/Суть экологии. Теория систем. Живые системы.  (Общая экология)(1-90) (1).xlsx")

names(test_lecture_1) <- c("St_Mail", "Score_lecture_1")

# test_lecture_1[test_lecture_1$St_Mail == "st092164@student.spbu.ru", ]


credits <- merge(credits, test_lecture_1, all.x = TRUE)

# credits[credits$St_Mail == "st092164@student.spbu.ru", ]

add_score <- data.frame(St_Mail = "st078729@student.spbu.ru", Addition = 1)

credits <- merge(credits, add_score, by.x = "St_Mail", all.x = TRUE)



#Тест по Лекции 2
test_lecture_2 <- read_xlsx("data/Аутэкология. (Общая экология)(1-87).xlsx")
test_lecture_2 <- test_lecture_2 %>% select(1,2)
names(test_lecture_2) <- c("St_Mail", "Score_lecture_2")

credits <- merge(credits, test_lecture_2, all.x = TRUE)


#Тест по Лекции 3
test_lecture_3 <- read_xlsx("data/Демэкология. Структура популяции. (Общая экология)(1-85).xlsx")
test_lecture_3 <- test_lecture_3 %>% select(1,2)
names(test_lecture_3) <- c("St_Mail", "Score_lecture_3")

credits <- merge(credits, test_lecture_3, all.x = TRUE)

credits$Addition_2 <- 1


#Тест по Лекции 4, 5, 6
test_lecture_4 <- read_xlsx("data/Динамика популяции. Взаимоотношения. (Общая экология)(1-82).xlsx")
test_lecture_4 <- test_lecture_4 %>% select(1,2)
names(test_lecture_4) <- c("St_Mail", "Score_lecture_4")

credits <- merge(credits, test_lecture_4, all.x = TRUE)

credits$Addition_3 <- 6




#Вывод общей таблицы с баллами

credits_sum <- 10 + 9 + 14

credits_print <- credits[, -1]

credits_print$Sum <- credits_print %>% select(-c("Login")) %>% rowSums(na.rm=TRUE) 

credits_print$Credit_Sum <- credits_sum 

credits_print$Proportion_of_final <- credits_print$Sum / credits_print$Credit_Sum 

```

**Состояние индивидуального счета студентов**  

```{r, echo=F}

options(knitr.kable.NA = '-')
kable(credits_print)

```



**Большое спасибо тем, кто принял участие в обсуждении вопросов теста по лекциям 21.10.2020 !**

Самое ценное в исследователе- это умение сомневаться :)


<!-- **Внимание**    -->
<!-- В графе *"Proportion_of_final"* Публикуется текущее количество набранных баллов, которое войдет в финальную оценку. Однако, эта величина будет изменяться, так как общее количество баллов, которое приводится в графе *"Credit_Sum"*, тоже будет изменяться по мере открытия новых заданий.  -->

Следите за текущим счетом и если что-то не так, то пишите.


<br>
<br>

# **Анализ отчетов по самостоятельной работе № 1**


```{r,  echo=FALSE, message=FALSE, warning=FALSE}
hw1 <- read.csv("data/Самостоятельная работа №1 Основные вопросы.csv", header = T)
hw1 <- hw1[1:2]
names(hw1)[2] <- "Login"

hw1 <- hw1 %>% group_by(Login) %>% summarise(Score = max(Score))

add_hw1 <- read.csv("data/Самостоятельная работа №1 Дополнительный вопрос.csv", header = T)
names(add_hw1) <- c("Login", "add_score")

add_hw1 <- add_hw1 %>% group_by(Login) %>% summarise(add_score = max(add_score))

# hw1[!(hw1$Login %in% add_hw1$Login), ]


hw1_score <- class %>% select(Login, Group)

hw1_score <- merge(hw1_score, hw1, all.x = T)

hw1_score <- merge(hw1_score, add_hw1, all.x = T)

hw1_score$Sum <- hw1_score %>% select(Score, add_score) %>% rowSums(., na.rm = T)

hw1_score$Total <- hw1_score$Sum/30

hw1_score_print <- hw1_score %>% select(Login, Score, add_score, Sum, Total)

kable(hw1_score_print)

```




