---
title: Анализ работы
---



```{r,  echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(dplyr)
library(readxl)


class <- read_xlsx("data/Classess_2020.xlsx", sheet = "Sheet1", col_names = T)
class <- class %>% filter(!is.na(Login)|!is.na(Group) )
class <- class[, 1:7]



# class[is.na(class$St_Mail),]

credits <- class %>% select(Login, St_Mail)

#Тест по Лекции 1
test_lecture_1 <- read.csv("data/Оценки класса Общая экология — 30.09.2020, 8-08.csv")
test_lecture_1 <- test_lecture_1 %>% select(3:4)
names(test_lecture_1) <- c("St_Mail", "Score_lecture_1")

credits <- merge(credits, test_lecture_1, all.x = TRUE)

add_score <- data.frame(St_Mail = "st078729@student.spbu.ru", Addition = 1)

credits <- merge(credits, add_score, by.x = "St_Mail", all.x = TRUE)



#Тест по Лекции 2
test_lecture_2 <- read_xlsx("data/Аутэкология. (Общая экология)(1-87).xlsx")
test_lecture_2 <- test_lecture_2 %>% select(1,3)
names(test_lecture_2) <- c("St_Mail", "Score_lecture_2")

credits <- merge(credits, test_lecture_2, all.x = TRUE)


#Тест по Лекции 3
test_lecture_3 <- read_xlsx("data/Демэкология. Структура популяции. (Общая экология)(1-85).xlsx")
test_lecture_3 <- test_lecture_3 %>% select(1,3)
names(test_lecture_3) <- c("St_Mail", "Score_lecture_3")

credits <- merge(credits, test_lecture_3, all.x = TRUE)

credits$Addition_2 <- 1

#Вывод общей таблицы с баллами

credits_sum <- 10 + 9

credits_print <- credits[, -1]

credits_print$Sum <- credits_print %>% select(-1) %>% rowSums(na.rm=TRUE) 

credits_print$Credit_Sum <- credits_sum 

credits_print$Proportion_of_final <- credits_print$Sum / credits_print$Credit_Sum 

```

Состояние индивидуального счета студентов  

```{r, echo=F}

options(knitr.kable.NA = '-')
kable(credits_print)

```


**Замечание:**

В любой большой работе бывают сбои. Спасибо тем, кто обнаруживает ошибки (значит разобрались в вопросе, что и является задачей курса).  Для оплаты ваших затрат на улучшение курса будем начислять дополнительные баллы.  

**Внимание**   
В графе *"Proportion_of_final"* Публикуется текущее количество набранных баллов, которое войдет в финальную оценку. Однако, эта величина будет изменяться, так как общее количество баллов, которое приводится в графе *"Credit_Sum"*, тоже будет изменяться по мере открытия новых заданий. 

Следите за текущим счетом и если что-то не так, то пишите.


<!-- # Результаты самостоятельной работы № 1 -->

<!-- ```{r,  echo=FALSE} -->
<!-- hw_res <- merge(class[, c("Name", "Group", "ID")], hw1, by = "ID") -->



<!-- hw_res <- hw_res[ , c(1,2,3, 6:39)] -->

<!-- Max <- length(names(hw_res)[8:ncol(hw_res)]) -->

<!-- hw_res$Score_HW_1 <- apply(hw_res[ , 4:ncol(hw_res)], MARGIN = 1, FUN = sum) -->

<!-- hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] <- hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] + 1  -->

<!-- hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] <- hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] + 4  -->

<!-- hw_res$Score_HW_1 <- hw_res$Score_HW_1/Max*3 -->

<!-- hw_res <- hw_res[, c("Name", "Group", "ID", "Score_HW_1")] -->
<!-- hw_res <- hw_res[order(hw_res$ID), ] -->
<!-- # write.table(hw_res, "clipboard", sep = "\t", row.names = F) -->



<!-- library(ggplot2) -->

<!-- ggplot(hw_res, aes(x = Group, y = Score_HW_1)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3) -->


<!-- ``` -->



<!-- # Контрольная работа № 1 -->

<!-- ## Распределение результатов -->

<!-- Вот такие предварительные результаты по контрольной. -->


<!-- ```{r, echo=FALSE} -->
<!-- class <- read.csv("data/class.csv") -->

<!-- class <- class[, c("Name", "ID", "Group")] -->
<!-- reasult <- read.csv("data/controlwork_1.csv", encoding = "Utf-8") -->
<!-- res <- merge(class, reasult, by = "ID") -->

<!-- res$sum <- apply(res[,-c(1:5)], MARGIN = 1, FUN = sum) -->

<!-- Max <- ncol(res[,-c(1:5, ncol(res))]) -->

<!-- res$Prop <- res$sum / Max  * 10 -->

<!-- # write.table(res, "clipboard", sep = "\t", row.names = F) -->

<!-- library(ggplot2) -->

<!-- # library(doBy) -->
<!-- # -->
<!-- # res_out <- summaryBy(sum ~ Group, data = res) -->

<!-- ggplot(res, aes(x = Group, y =  Prop)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3) -->


<!-- ``` -->




<!-- ## Время выполнения работы -->

<!-- А вот так выглядит степень скоординированности работы студентов. -->

<!-- ```{r, echo=FALSE, message=FALSE, warning=F} -->
<!-- contr_trial <- read.csv("data/Control1_attempts.csv", header = T) -->

<!-- contr_trial$submission_date_time <- as.POSIXct(contr_trial$submission,format = "%d-%m %H:%M") -->


<!-- ggplot(contr_trial, aes(x = Group, y = submission_date_time)) + geom_boxplot() + labs(x = "Группа", y = "Час, когда начали работу") -->



<!-- ``` -->





<!-- # Результаты самостоятельной работы № 2 -->

<!-- ```{r,  echo=FALSE} -->


<!-- class <- read.csv("data/class.csv") -->

<!-- hw2 <- read.csv("data/homework_2.csv") -->

<!-- class$Name <- as.character(class$Name) -->



<!-- hw_res <- merge(class[, c("Name", "Group", "ID")], hw2, by = "ID") -->



<!-- hw_res <- hw_res[ , c(1,2,3, 6:ncol(hw_res))] -->

<!-- Max <- length(names(hw_res)[4:ncol(hw_res)]) -->

<!-- hw_res$Score_HW_2 <- apply(hw_res[ , 4:ncol(hw_res)], MARGIN = 1, FUN = sum) -->
<!-- #  -->
<!-- # hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] <- hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] + 1  -->
<!-- #  -->
<!-- hw_res$Score_HW_2[hw_res$Name == "Каськова Ксения"] <- hw_res$Score_HW_2[hw_res$Name == "Каськова Ксения"] + 5 -->

<!-- hw_res$Score_HW_2 <- hw_res$Score_HW_2/(Max-1)*3 -->

<!-- hw_res <- hw_res[, c("Name", "Group", "ID", "Score_HW_2")] -->
<!-- hw_res <- hw_res[order(hw_res$ID), ] -->
<!-- # write.table(hw_res, "clipboard", sep = "\t", row.names = F) -->



<!-- library(ggplot2) -->

<!-- ggplot(hw_res, aes(x = Group, y = Score_HW_2)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3) -->



<!-- ``` -->






<!-- # Результаты самостоятельной работы № 3 -->

<!-- ```{r,  echo=FALSE} -->


<!-- class <- read.csv("data/class.csv") -->

<!-- hw3 <- read.csv("data/homework_3.csv") -->

<!-- class$Name <- as.character(class$Name) -->



<!-- hw_res <- merge(class[, c("Name", "Group", "ID")], hw3, by = "ID") -->



<!-- hw_res <- hw_res[ , c(1,2,3, 6:ncol(hw_res))] -->

<!-- Max <- 27 -->

<!-- hw_res$Score_HW_3 <- apply(hw_res[ , 4:ncol(hw_res)], MARGIN = 1, FUN = sum) -->
<!-- #  -->
<!-- # hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] <- hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] + 1  -->
<!-- #  -->
<!-- hw_res$Score_HW_3[hw_res$Name == "Каськова Ксения"] <- hw_res$Score_HW_3[hw_res$Name == "Каськова Ксения"] + 5 + 1 -->

<!-- hw_res$Score_HW_3 <- hw_res$Score_HW_3/Max*3 -->

<!-- hw_res <- hw_res[, c("Name", "Group", "ID", "Score_HW_3")] -->
<!-- hw_res <- hw_res[order(hw_res$ID), ] -->
<!-- # write.table(hw_res, "clipboard", sep = "\t", row.names = F) -->



<!-- library(ggplot2) -->

<!-- ggplot(hw_res, aes(x = Group, y = Score_HW_3)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3) -->



<!-- ``` -->




<!-- # Контрольная работа № 2 -->

<!-- ## Распределение результатов -->

<!-- Вот такие предварительные результаты по второй контрольной. -->


<!-- ```{r, echo=FALSE} -->
<!-- class <- read.csv("data/class.csv") -->

<!-- class <- class[, c("Name", "ID", "Group")] -->
<!-- reasult <- read.csv("data/controlwork_2.csv", encoding = "Utf-8") -->
<!-- res <- merge(class, reasult, by = "ID") -->

<!-- res$sum <- apply(res[,-c(1:5)], MARGIN = 1, FUN = sum) -->

<!-- Max <- ncol(res[,-c(1:5, ncol(res))]) -->

<!-- res$Prop <- res$sum / Max  * 10 -->

<!-- # write.table(res, "clipboard", sep = "\t", row.names = F) -->

<!-- library(ggplot2) -->

<!-- # library(doBy) -->
<!-- # -->
<!-- # res_out <- summaryBy(sum ~ Group, data = res) -->

<!-- ggplot(res, aes(x = Group, y =  Prop)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 10) -->


<!-- ``` -->



<!-- # Текущие оценки  -->
<!-- Коллеги, для сохранения персональных данных в тайне, вывешиваются только номера ID. Поэтому для поиска информации о себе выясните на Степике свой ID. -->

<!-- ```{r, echo=FALSE, message=FALSE, warning=F} -->
<!-- class <- read.csv("data/class.csv") -->

<!-- results_print <- class[, c("ID", "Seminar_1",	"Seminar_2",	"Seminar_3",	"Seminar_4",	"Seminar_5",	"Seminar_6", 	"Seminar_7", 	"HW_1",	"HW_2",	"HW_3",	"Control_1",	"Control_2")] -->

<!-- results_print <- results_print[!is.na(results_print$ID), ] -->

<!-- results_print[is.na(results_print)] <- 0 -->
<!-- options(knitr.kable.NA = '') -->

<!-- results_print[,2:8] <- results_print[,2:8]/1*3 -->

<!-- results_print$Sum <- apply(results_print[,2:13], MARGIN = 1, FUN = sum) -->


<!-- # Надбавка за помощь Мешковский Сергей, Такки Ольга -->

<!-- results_print$Sum[results_print$ID %in% c(19491533, 96556392)] <- results_print$Sum[results_print$ID %in% c(19491533, 96556392)] + 5 -->

<!-- # write.table(merge(class[,c("ID", "Name"), ], results_print), "clipboard", sep = "\t", row.names = F, fileEncoding = "utf8") -->



<!-- kable(results_print, col.names = c("ID", "Сем.1", "Сем.2", "Сем.3",  "Сем.4", "Сем.5", "Сем.6", "Сем.7",  "СР1", "СР2", "СР3", "КР1", "КР2", "Сумма"), digits = 1) -->

<!-- ``` -->

