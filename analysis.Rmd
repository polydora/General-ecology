---
title: Анализ работы
---

<!-- **Важные задолженности!** -->

<!-- Коллеги! В настоящий момент большая часть курса зарегистрировалась в системе Stepik, и прошли первый тест! Однако есть несколько человек, которые значатся на курсе, но пока не зарегистрировались. Если их ID не станет известен в ближайшее время, то за первый тест у них не будут начислены баллы.  -->

<!-- Вот эти люди. -->

```{r,  echo=FALSE}
library(knitr)


class <- read.csv("data/class.csv")

hw1 <- read.csv("data/homework_1.csv")

class$Name <- as.character(class$Name)

class_dolg <- class[is.na(class$ID), ]

# kable(class_dolg[ , 1], col.names = "Ф.И.")
```

# Результаты самостоятельной работы № 1

```{r,  echo=FALSE}
hw_res <- merge(class[, c("Name", "Group", "ID")], hw1, by = "ID")



hw_res <- hw_res[ , c(1,2,3, 6:39)]

Max <- length(names(hw_res)[8:ncol(hw_res)])

hw_res$Score_HW_1 <- apply(hw_res[ , 4:ncol(hw_res)], MARGIN = 1, FUN = sum)

hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] <- hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] + 1 

hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] <- hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] + 4 

hw_res$Score_HW_1 <- hw_res$Score_HW_1/Max*3

hw_res <- hw_res[, c("Name", "Group", "ID", "Score_HW_1")]
hw_res <- hw_res[order(hw_res$ID), ]
# write.table(hw_res, "clipboard", sep = "\t", row.names = F)



library(ggplot2)

ggplot(hw_res, aes(x = Group, y = Score_HW_1)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3)


```

Группа №3 впереди всех! Остальные тоже молодцы...  






# Контрольная работа № 1

## Распределение результатов

Вот такие предварительные результаты по контрольной.


```{r, echo=FALSE}
class <- read.csv("data/class.csv")

class <- class[, c("Name", "ID", "Group")]
reasult <- read.csv("data/controlwork_1.csv", encoding = "Utf-8")
res <- merge(class, reasult, by = "ID")

res$sum <- apply(res[,-c(1:5)], MARGIN = 1, FUN = sum)

Max <- ncol(res[,-c(1:5, ncol(res))])

res$Prop <- res$sum / Max  * 10

# write.table(res, "clipboard", sep = "\t", row.names = F)

library(ggplot2)

# library(doBy)
#
# res_out <- summaryBy(sum ~ Group, data = res)

ggplot(res, aes(x = Group, y =  Prop)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3)


```




## Время выполнения работы

А вот так выглядит степень скоординированности работы студентов.

```{r, echo=FALSE, message=FALSE, warning=F}
contr_trial <- read.csv("data/Control1_attempts.csv", header = T)

contr_trial$submission_date_time <- as.POSIXct(contr_trial$submission,format = "%d-%m %H:%M")


ggplot(contr_trial, aes(x = Group, y = submission_date_time)) + geom_boxplot() + labs(x = "Группа", y = "Час, когда начали работу")



```



Группа № 2, видимо, самая дружная :), у них минимальный разброс значений. Коллективная работа... Я не против... но экзамен будет индивидуальным...  

## Кто раньше, тот лучше

Посмотрите на результаты регрессионного анализа, который описывает связь вероятности правильного ответа на вопросы контрольной работы, с тем, когда происходило решение задач. 

```{r, echo=FALSE, message=FALSE, warning=F}
library(dplyr)
contr_trial$Out <- ifelse(contr_trial$status == "correct", 1, 0)

Mod_time <- glm(Out ~ submission_date_time, data = contr_trial, family = "binomial")


new_data <- data.frame(submission_date_time = seq(min(contr_trial$submission_date_time, na.rm = T), max(contr_trial$submission_date_time, na.rm = T), length.out = 100))

new_data$Predict <- predict(Mod_time, newdata =new_data, type = "response", se.fit = T)$fit
new_data$SE <- predict(Mod_time, newdata =new_data, type = "response", se.fit = T)$se.fit


ggplot(new_data, aes(x = submission_date_time, y = Predict)) + geom_line(color = "blue", size = 2) + geom_ribbon(aes(ymin = Predict - 1.96*SE, ymax = Predict + 1.96*SE), alpha = 0.2) + labs(x = "Время решеня задачи", y = "Вероятность правильного решения")


```


Результаты статистически значимы и характер связи очевиден: те, кто раньше берется за контрольную, те с большей вероятностью решают ее правильно. Думайте над механизмами этой связи :)



# Результаты самостоятельной работы № 2

```{r,  echo=FALSE}


class <- read.csv("data/class.csv")

hw2 <- read.csv("data/homework_2.csv")

class$Name <- as.character(class$Name)



hw_res <- merge(class[, c("Name", "Group", "ID")], hw2, by = "ID")



hw_res <- hw_res[ , c(1,2,3, 6:ncol(hw_res))]

Max <- length(names(hw_res)[4:ncol(hw_res)])

hw_res$Score_HW_2 <- apply(hw_res[ , 4:ncol(hw_res)], MARGIN = 1, FUN = sum)
# 
# hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] <- hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] + 1 
# 
# hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] <- hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] + 4 

hw_res$Score_HW_2 <- hw_res$Score_HW_2/Max*3

hw_res <- hw_res[, c("Name", "Group", "ID", "Score_HW_2")]
hw_res <- hw_res[order(hw_res$ID), ]
# write.table(hw_res, "clipboard", sep = "\t", row.names = F)



library(ggplot2)

ggplot(hw_res, aes(x = Group, y = Score_HW_2)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3)



```


На этот раз вперед вырвались группы 6 и 7. А вот группа 3 что-то сдала позиции...




# Результаты самостоятельной работы № 3

```{r,  echo=FALSE}


class <- read.csv("data/class.csv")

hw3 <- read.csv("data/homework_3.csv")

class$Name <- as.character(class$Name)



hw_res <- merge(class[, c("Name", "Group", "ID")], hw3, by = "ID")



hw_res <- hw_res[ , c(1,2,3, 6:ncol(hw_res))]

Max <- 27

hw_res$Score_HW_3 <- apply(hw_res[ , 4:ncol(hw_res)], MARGIN = 1, FUN = sum)
# 
# hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] <- hw_res$Score_HW_1[hw_res$Name == "Леняшина Мария"] + 1 
# 
# hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] <- hw_res$Score_HW_1[hw_res$Name == "Каськова Ксения"] + 4 

hw_res$Score_HW_3 <- hw_res$Score_HW_3/Max*3

hw_res <- hw_res[, c("Name", "Group", "ID", "Score_HW_3")]
hw_res <- hw_res[order(hw_res$ID), ]
# write.table(hw_res, "clipboard", sep = "\t", row.names = F)



library(ggplot2)

ggplot(hw_res, aes(x = Group, y = Score_HW_3)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 3)



```


На этот раз всех победила группа № 7!




# Контрольная работа № 2

## Распределение результатов

Вот такие предварительные результаты по второй контрольной.


```{r, echo=FALSE}
class <- read.csv("data/class.csv")

class <- class[, c("Name", "ID", "Group")]
reasult <- read.csv("data/controlwork_2.csv", encoding = "Utf-8")
res <- merge(class, reasult, by = "ID")

res$sum <- apply(res[,-c(1:5)], MARGIN = 1, FUN = sum)

Max <- ncol(res[,-c(1:5, ncol(res))])

res$Prop <- res$sum / Max  * 10

# write.table(res, "clipboard", sep = "\t", row.names = F)

library(ggplot2)

# library(doBy)
#
# res_out <- summaryBy(sum ~ Group, data = res)

ggplot(res, aes(x = Group, y =  Prop)) + geom_boxplot() + ggtitle("Количесвто баллов по каждой группе") + labs(x = "Группа", y = "Итоговые баллы") + geom_hline(yintercept = 10)


```

И опять группа № 7 на высоте!




# Текущие оценки 
Коллеги, для сохранения персональных данных в тайне, вывешиваются только номера ID. Поэтому для поиска информации о себе выясните на Степике свой ID.

```{r, echo=FALSE, message=FALSE, warning=F}
class <- read.csv("data/class.csv")

results_print <- class[, c("ID", "Seminar_1",	"Seminar_2",	"Seminar_3",	"Seminar_4",	"Seminar_5",	"Seminar_6", 	"Seminar_7", 	"HW_1",	"HW_2",	"HW_3",	"Control_1",	"Control_2")]

results_print <- results_print[!is.na(results_print$ID), ]

results_print[is.na(results_print)] <- 0
options(knitr.kable.NA = '')

results_print[,2:8] <- results_print[,2:8]/1*3

results_print$Sum <- apply(results_print[,-c(1, ncol(results_print))], MARGIN = 1, FUN = sum)

kable(results_print, col.names = c("ID", "Сем.1", "Сем.2", "Сем.3",  "Сем.4", "Сем.5", "Сем.6", "Сем.7",  "СР1", "СР2", "СР3", "КР1", "КР2", "Сумма"), digits = 1)

```


<!-- <!-- ```{r} --> -->
<!-- <!-- cheat <- read.csv("data/Control_work_1_cheating.csv") --> -->
<!-- <!-- cheat_res <- merge(class, cheat) --> -->

<!-- <!-- cheat_res <- cheat_res[cheat_res$lesson_id %in% c(179985, 180749),] --> -->
<!-- <!-- ggplot(cheat_res, aes(x = as.factor(Group), y = cheat )) + geom_boxplot() --> -->
<!-- <!-- ``` --> -->

<!-- ## Трудность вопросов -->

<!-- А вот так выглядит распределение по количеству верных ответов на вопросы  -->

<!-- ```{r, echo=FALSE} -->
<!-- res_Q <- apply(res[,-c(1:8)], MARGIN = 2, FUN = sum)[1:22] -->

<!-- res_Q <- res_Q[order(res_Q)] -->
<!-- answers <- data.frame(Question = names(res_Q), Prop_TRUE = res_Q/nrow(res) *100) -->

<!-- answers <- answers[order(answers$Prop_TRUE),] -->

<!-- answers$Goodness <- ifelse(answers$Prop_TRUE < median(answers$Prop_TRUE), "Плохой вопрос", "Хороший вопрос") -->

<!-- ggplot(answers, aes(y=Prop_TRUE, x = Question)) + geom_col(aes(fill= Goodness)) + coord_flip() + scale_fill_manual(values = c("red", "green")) + labs(fill = "", x = "Вопрос", y = "% Правильных ответов") -->


<!-- ``` -->



<!-- # Домашняя работа № 1 -->

<!-- ## Распределение результатов по группам -->

<!-- ```{r, echo=FALSE} -->
<!-- class <- read.csv("data/class.csv") -->
<!-- reasult_hw <- read.csv("data/Home_work_1.csv", encoding = "Utf-8") -->
<!-- res <- merge(class, reasult_hw) -->
<!-- res$sum <- apply(res[,-c(1:7)], MARGIN = 1, FUN = sum) -->
<!-- res$Prop <- res$sum / ncol(res[,-c(1:8)]) * 100    -->

<!-- ggplot(res, aes(x = factor(Group), y = Prop)) + geom_boxplot() + labs(x = "Группа", y = "Доля правильных ответов") + geom_hline(yintercept = c(49, 60, 80)) -->


<!-- ``` -->


<!-- Замечательные результаты! Большинство получили пятерки. Это радует...  -->

<!-- Не раслабляйтесь, второе домашнее задание уже открыто. -->





<!-- # Домашняя работа № 2 -->

<!-- ## Распределение результатов по группам -->

<!-- ```{r, echo=FALSE} -->
<!-- class <- read.csv("data/class.csv") -->
<!-- reasult_hw <- read.csv("data/Home_work_2.csv", encoding = "Utf-8") -->
<!-- res <- merge(class, reasult_hw) -->
<!-- res$sum <- apply(res[,-c(1:7)], MARGIN = 1, FUN = sum) -->
<!-- res$Prop <- res$sum / ncol(res[,-c(1:8)]) * 100    -->

<!-- ggplot(res, aes(x = factor(Group), y = Prop)) + geom_boxplot() + labs(x = "Группа", y = "Доля правильных ответов") + geom_hline(yintercept = c(49, 60, 80)) -->


<!-- ``` -->


<!-- Отлично! Почти все получили пятерки...  -->

<!-- Уже боюсь вас на экзамене :) -->

<!-- Не раслабляйтесь, третье домашнее задание уже открыто. -->



<!-- # Контрольная работа № 2 -->

<!-- ## Распределение результатов -->


<!-- ```{r, echo=FALSE} -->
<!-- class <- read.csv("data/class.csv") -->
<!-- reasult <- read.csv("data/Control_work_2.csv", encoding = "Utf-8") -->
<!-- res <- merge(class, reasult) -->
<!-- res$sum <- apply(res[,-c(1:8)], MARGIN = 1, FUN = sum) -->
<!-- res$Prop <- res$sum / ncol(res[,-c(1:8)]) * 100    -->

<!-- library(ggplot2)  -->

<!-- # library(doBy) -->
<!-- #  -->
<!-- # res_out <- summaryBy(sum ~ Group, data = res) -->

<!-- ggplot(res, aes(x = Prop)) + geom_histogram(fill = "blue", color = "black", binwidth = 10) + labs(x = "Процент правильных ответов") + geom_vline(xintercept = 49) + geom_text(aes(x = 60, y = 40, label = "Зачет")) -->

<!-- ``` -->

<!-- По-моему, стало заметно лучше, чем в предыдущий раз. Странно... работа, по-моему, сложнее. Впрочем, см. ниже оценку времени выхода в эфир. -->




<!-- А вот так выглядит распределение по группам. Горизотальные линии отделяют тройку (50-60%), четверку (60-80%) и пятерку (более 80%). Соотношние между группами не изменилось, но зато резко упала дисперсия, что тоже хорошо. -->


<!-- ```{r, echo=FALSE} -->
<!-- ggplot(res, aes(x = factor(Group), y = Prop)) + geom_boxplot() + labs(x = "Группа", y = "Количество правильных ответов") + geom_hline(yintercept = c(49, 60, 80)) -->

<!-- ``` -->


<!-- ## Распределение оценок на контрольной №2 -->

<!-- ```{r, echo=FALSE} -->
<!-- res$credit[res$Prop >= 80] <- 5 -->

<!-- res$credit[res$Prop < 80 & res$Prop >= 60 ] <- 4 -->

<!-- res$credit[res$Prop < 60 & res$Prop >= 50 ] <- 3 -->

<!-- res$credit[res$Prop < 50 ] <- 2 -->

<!-- credits <- as.data.frame(table(res$credit)) -->
<!-- names(credits) <- c("Оценка", "Количество студентов") -->
<!-- library(knitr) -->
<!-- kable (credits, align = "cc") -->

<!-- ``` -->



<!-- ## Время выполнения работы -->


<!-- ```{r, echo=FALSE} -->
<!-- time <- read.csv("data/Control_work_2_time.csv") -->
<!-- time_res <- merge(class, time) -->

<!-- time_res$start_date <- format(time_res$start_date,format = "%Y-%m-%d %H:%M:%S" ) -->

<!-- time_res$start_date <- strptime(time_res$start_date, format ="%Y-%m-%d %H:%M:%S"  ) -->

<!-- time_res$start_H <- as.numeric(format(time_res$start_date, "%H")) + as.numeric(format(time_res$start_date, "%M"))/60  -->


<!-- ggplot(time_res, aes(x = as.factor(Group), y = start_H)) + geom_boxplot() + labs(x = "Группа", y = "Час, когда начали работу") -->


<!-- ``` -->


<!-- Ух, как все скоординировались-то! :)  -->

<!-- Коллективный разум - это круто!  -->

<!-- Но не забывайте, что **на экзамене придется отдуваться в идивидуальном порядке**... -->


<!-- ## Трудность вопросов -->

<!-- А вот так выглядит распределение по количеству верных ответов на вопросы  -->

<!-- ```{r, echo=FALSE} -->
<!-- res_Q <- apply(res[,-c(1:8)], MARGIN = 2, FUN = sum)[1:25] -->

<!-- res_Q <- res_Q[order(res_Q)] -->
<!-- answers <- data.frame(Question = names(res_Q), Prop_TRUE = res_Q/nrow(res) *100) -->

<!-- answers <- answers[order(answers$Prop_TRUE),] -->

<!-- answers$Goodness <- ifelse(answers$Prop_TRUE < median(answers$Prop_TRUE), "Плохой вопрос", "Хороший вопрос") -->

<!-- ggplot(answers, aes(y=Prop_TRUE, x = Question)) + geom_col(aes(fill= Goodness)) + coord_flip() + scale_fill_manual(values = c("red", "green")) + labs(fill = "", x = "Вопрос", y = "% Правильных ответов") -->


<!-- ``` -->



<!-- # Домашняя работа № 3 -->

<!-- ## Распределение результатов по группам -->

<!-- ```{r, echo=FALSE} -->
<!-- class <- read.csv("data/class.csv") -->
<!-- reasult_hw <- read.csv("data/Home_work_3.csv", encoding = "Utf-8") -->
<!-- res <- merge(class, reasult_hw) -->
<!-- res$sum <- apply(res[,-c(1:7)], MARGIN = 1, FUN = sum) -->
<!-- res$Prop <- res$sum / sum(reasult_hw[1, -c(1:3)]) * 100    -->

<!-- ggplot(res, aes(x = factor(Group), y = Prop)) + geom_boxplot() + labs(x = "Группа", y = "Доля правильных ответов") + geom_hline(yintercept = c(49, 60, 80)) -->


<!-- ``` -->


<!-- # Финальные результаты по Домашним работам и по Контрольным -->

<!-- ```{r, echo=FALSE} -->
<!-- class <- read.csv("data/class.csv") -->
<!-- reasult_hw1 <- read.csv("data/Home_work_1.csv", encoding = "Utf-8") -->
<!-- reasult_hw2 <- read.csv("data/Home_work_2.csv", encoding = "Utf-8") -->
<!-- reasult_hw3 <- read.csv("data/Home_work_3.csv", encoding = "Utf-8") -->


<!-- reasult_contr1 <- read.csv("data/Control_work_1.csv", encoding = "Utf-8") -->
<!-- reasult_contr2 <- read.csv("data/Control_work_2.csv", encoding = "Utf-8") -->



<!-- tmp <- merge(reasult_hw1, reasult_hw2[,-c(2:3)], by = c("user_id")) -->
<!-- all_hw <- merge(tmp,reasult_hw3[,-c(2:3)], by = c("user_id")) -->

<!-- Total_sum_hw <- sum(all_hw[all_hw$user_id == 28414308, ][1, -c(1:3)]) -->

<!-- all_hw$sum <- apply(all_hw[,-c(1:3)], MARGIN = 1, FUN = sum) -->


<!-- all_contr <- merge(reasult_contr1, reasult_contr2[,-c(2:3)], by = c("user_id")) -->


<!-- Total_sum_contr <- sum(as.numeric(all_contr[all_contr$user_id == 28414308, ][-c(1:3)])) -->

<!-- all_contr$sum <- apply(all_contr[,-c(1:3)], MARGIN = 1, FUN = sum) -->


<!-- res_hw <- merge(class, all_hw[,c("user_id", "last_name", "first_name", "sum")]) -->

<!-- res_contr <- merge(class, all_contr[,c("user_id", "last_name", "first_name", "sum")]) -->

<!-- res <- merge(res_hw, res_contr, by = c("user_id")) -->

<!-- result_total <- data.frame(Name = paste(res$Last_name.x, " ", res$First_name.x), Group = res$Group.x,  Sum_Contr = res$sum.y, Sum_HW = round(res$sum.x)) -->



<!-- result_total <- result_total[!is.na(result_total$Group), ]  -->


<!-- result_total <- result_total[order(result_total$Group), ] -->



<!-- sem_fin <- read.csv("data/Seminars_2018_final.csv", header = TRUE) -->

<!-- sem_fin_2 <- data.frame(Name = paste(sem_fin$Last_name," ",sem_fin$First_name), Seminar_score = sem_fin$Score*3) -->


<!-- result_total <- merge(result_total, sem_fin_2) -->

<!-- result_total$Sum_Contr <- round(result_total$Sum_Contr/49*100) -->
<!-- result_total$Sum_HW <- round(result_total$Sum_HW/77*100) -->



<!-- #  -->
<!-- # kable(result_total, col.names = c("Ф. И.", "Группа", "Контрольные (макс. 49)", "Самостоятельные (макс.77)"), align = "lccc", row.names = FALSE) -->


<!-- kable(result_total, col.names = c("Ф. И.", "Группа", "Контрольные %", "Самостоятельные %", "Надбавка за семинары"), align = "lcccc", row.names = FALSE) -->

<!-- ``` -->



<!-- # Файл с оценками за самостоятельные работы и контрольные работы -->

<!-- - [Оценки](data/all_credits.xlsx) -->






