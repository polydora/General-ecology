---
title: Анализ работы
---

Здесь будут выкладываться текущие результаты ваших работ.




```{r,  echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(dplyr)
library(readxl)
library(ggplot2)
library(broom)
library(tidyr)


class <- read_xlsx("data/Classess_2023_biotech.xlsx", col_names = T)
class <- class %>% filter(!is.na(Login)|!is.na(Group) )
class <- class %>% select(St_Mail, Login)


opts_chunk$set(echo = FALSE)

```



# **Анализ тестов по материалам лекций**

Максимальное количество баллов для экзамена: 8%



```{r,  echo=FALSE, message=FALSE, warning=FALSE}

credits <- class %>% select(Login, St_Mail)

# Тест по Лекции 1
test_lecture_1 <- read_excel("data/Основы ОТС и Предмет экологии  (Общая экология для биоинженеров 2023)(1-10).xlsx", na = "NA")

test_lecture_1 <- test_lecture_1 %>% select(c(1,3))


names(test_lecture_1) <- c("St_Mail", "Score_lecture_1")


credits <- merge(credits, test_lecture_1, all.x = TRUE)



#Тест по Лекции 2

test_lecture_2 <- read_xlsx("data/Аутэкология (Общая экология для биоинженеров 2023)(1-10).xlsx")


#
#
#

test_lecture_2 <- test_lecture_2 %>% select(1,3)
names(test_lecture_2) <- c("St_Mail", "Score_lecture_2")

credits <- merge(credits, test_lecture_2, all.x = TRUE)



#Тест по Лекции 3


test_lecture_3 <- read_xlsx("data/Структура популяций  (Общая экология для биоинженеров 2023)(1-10).xlsx")

test_lecture_3 <- test_lecture_3 %>% select(1,3)
names(test_lecture_3) <- c("St_Mail", "Score_lecture_3")

credits <- merge(credits, test_lecture_3, all.x = TRUE)

#
test_lecture_4 <- read_xlsx("data/Динамика популяций  (Общая экология для биоинженеров 2023)(1-10).xlsx")

test_lecture_4 <- test_lecture_4 %>% select(1,3)
names(test_lecture_4) <- c("St_Mail", "Score_lecture_4")

credits <- merge(credits, test_lecture_4, all.x = TRUE)
#
# 
# 
# test_lecture_5 <- read_xlsx("data/Конкуренция и трофические связи (Общая экология 2022)(1-85).xlsx")
# 
# test_lecture_5 <- test_lecture_5 %>% select(1,3)
# names(test_lecture_5) <- c("St_Mail", "Score_lecture_5")
# 
# credits <- merge(credits, test_lecture_5, all.x = TRUE)
# 
# 
# 
# 
# test_lecture_6 <- read_xlsx("data/Симбиозы и структура сообществ (Общая экология 2022)(1-64).xlsx")
# 
# test_lecture_6 <- test_lecture_6 %>% select(1,3)
# names(test_lecture_6) <- c("St_Mail", "Score_lecture_6")
# 
# credits <-  merge(credits, test_lecture_6, all.x = TRUE)



##########################
#Вывод общей таблицы с баллами

credits <- credits %>% filter(Login != "NA")

credits_sum <- 10 + 10 + 8 + 10 

credits_print <- credits %>% select(-St_Mail)

credits_print$Sum <- credits_print %>% select(-c("Login")) %>% rowSums(na.rm=TRUE)

credits_print$Credit_Sum <- credits_sum

credits_print$Proportion <- round(credits_print$Sum / credits_print$Credit_Sum, 2)

credits_print$Exam <- credits_print$Proportion * 8

# credits_print$Exam <- round(credits_print$Exam, 1) * 10 #умножаем на это число, так как от каждой из 8 лекций приходит 10/8 финальной оценки



```



**Состояние индивидуального счета студентов**

```{r, echo=F}

options(knitr.kable.NA = '-')

credits_print <- credits_print %>% filter(!is.na(Login)) %>% select(-Sum, -Credit_Sum)

kable(credits_print)


```











<!-- # **Анализ отчетов по самостоятельной работе № 1** -->


<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE} -->

<!-- hw1 <- read_xlsx("data/Тест по самостоятельной работе №1 (Общая экология 2021)(1-108).xlsx") -->
<!-- hw1 <- hw1[1:2] -->
<!-- names(hw1) <- c("Login", "Score") -->

<!-- hw1 <- hw1 %>% group_by(Login) %>% summarise(Score = max(Score)) -->

<!-- # add_hw1 <- read.csv("data/Самостоятельная работа №1 Дополнительный вопрос.csv", header = T) -->
<!-- # names(add_hw1) <- c("Login", "add_score") -->
<!-- #  -->
<!-- # add_hw1 <- add_hw1 %>% group_by(Login) %>% summarise(add_score = max(add_score)) -->
<!-- #  -->
<!-- # # hw1[!(hw1$Login %in% add_hw1$Login), ] -->
<!-- #  -->

<!-- # hw1_score <- class %>% select(St_Mail, Login) -->
<!-- #  -->
<!-- # hw1_score <- merge(hw1_score, hw1, all.x = T) -->
<!-- #  -->
<!-- # hw1_score <- merge(hw1_score, add_hw1, all.x = T) -->
<!-- #  -->
<!-- # hw1_score$Sum <- hw1_score %>% select(Score, add_score) %>% rowSums(., na.rm = T) -->

<!-- hw1_score <- hw1 -->

<!-- hw1_score$Total <- 15 -->

<!-- hw1_score$Exam <- round(hw1_score$Score / hw1_score$Total, 1) -->

<!-- # hw1_score_print <- hw1_score %>% select(Login, Score, add_score, Sum, Exam) -->

<!-- hw1_score_print <- hw1_score  -->

<!-- # kable(hw1_score_print, col.names = c("Login", "Основные вопросы", "Доп. вопр. 1", "Сумма",  "% от экзаменационной оценки")) -->

<!-- kable(hw1_score_print, col.names = c("Login", "Сумма", "Всего вопросов",  "% от экзаменационной оценки")) -->


<!-- ``` -->

<!-- <br> -->
<!-- <br> -->


<!-- # **Анализ отчетов по самостоятельной работе № 2** -->


<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE} -->

<!-- hw2 <- read_xlsx("data/Самостоятельная работа № 2 (Общая экология 2021)(1-89).xlsx") -->
<!-- hw2 <- hw2 %>% select(1, 3) -->
<!-- names(hw2) <- c("Login", "Score") -->


<!-- # add_hw1 <- read.csv("data/Самостоятельная работа №1 Дополнительный вопрос.csv", header = T) -->
<!-- # names(add_hw1) <- c("Login", "add_score") -->
<!-- #  -->
<!-- # add_hw1 <- add_hw1 %>% group_by(Login) %>% summarise(add_score = max(add_score)) -->
<!-- #  -->
<!-- # # hw1[!(hw1$Login %in% add_hw1$Login), ] -->
<!-- #  -->

<!-- # hw1_score <- class %>% select(St_Mail, Login) -->
<!-- #  -->
<!-- # hw1_score <- merge(hw1_score, hw1, all.x = T) -->
<!-- #  -->
<!-- # hw1_score <- merge(hw1_score, add_hw1, all.x = T) -->
<!-- #  -->
<!-- # hw1_score$Sum <- hw1_score %>% select(Score, add_score) %>% rowSums(., na.rm = T) -->

<!-- hw2_score <- hw2 -->

<!-- hw2_score$Total <- 18 -->

<!-- hw2_score$Exam <- round(hw2_score$Score / hw2_score$Total, 1) -->

<!-- # hw1_score_print <- hw1_score %>% select(Login, Score, add_score, Sum, Exam) -->

<!-- hw2_score_print <- hw2_score  -->

<!-- # kable(hw1_score_print, col.names = c("Login", "Основные вопросы", "Доп. вопр. 1", "Сумма",  "% от экзаменационной оценки")) -->

<!-- kable(hw2_score_print, col.names = c("Login", "Сумма", "Всего вопросов",  "% от экзаменационной оценки")) -->


<!-- ``` -->

<!-- <br> -->
<!-- <br> -->




<!-- # **Анализ отчетов по самостоятельной работе № 2** -->





<!-- **Господа!** Приношу извинения за задержку с публикацией оценок. Напоминаю, что баллы за эту работу дополнительные (те, кто работу не сделал, ничего не потерял... но и не приобрел:). Поскольку в результате высвободился 1%, он уходит в оценку за работы по тестам по материалам лекций (то есть вес этой оценки удваивается). -->



<!-- <br> -->
<!-- <br> -->


## **Анализ контрольной работы № 1**

Максимальное количество баллов для экзамена: 3%

<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE, eval=FALSE} -->

<!-- # cont1 <- read_excel("data/Контрольная работа № 1 (Общая экология для биоинженеров 2022)(1-28).xlsx") -->

<!-- cont1 <- read_excel("data/Контрольная работа № 1 (Общая экология 2022)(1-104).xlsx") -->
<!-- names(cont1) <- c("St_Mail","Name", "Score") -->

<!-- cont1_print <- merge(class, cont1 %>% select(-Name ) ) %>% select(-St_Mail) %>% mutate(Exam = round(Score / 24 * 1.5, 1) )  -->

<!-- kable(cont1_print) -->


<!-- ``` -->




## **Анализ контрольной работы № 2**


Максимальное количество баллов для экзамена 3%



<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE, eval=FALSE} -->

<!-- # cont1 <- read_excel("data/Control_work_1_biotech.xlsx") -->

<!-- cont2 <- read_excel("data/Контрольная работа № 2 (Общая экология 2022)(1-100).xlsx") -->
<!-- names(cont2) <- c("St_Mail",  "Name", "Score") -->

<!-- cont2_print <- merge(class, cont2 %>% select(-Name ) ) %>% select(-St_Mail) %>% mutate(Exam = round(Score / 13*1.5, 1)) -->

<!-- kable(cont2_print) -->


<!-- ``` -->






<!-- ## **Анализ самостоятельной работы № 1** -->

<!-- Максимальное количество баллов для экзамена 1.5% -->



<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE, eval=FALSE} -->

<!-- hw1 <- read_excel("data/Тест по самостоятельной работе №1 (Общая экология 2022)(1-98).xlsx") -->

<!-- hw1_score <- hw1 -->

<!-- names(hw1_score) <- c("St_Mail","Name", "Score") -->


<!-- hw1_score <- merge(class, hw1_score) %>% select(-c(St_Mail, Name)) -->


<!-- hw1_score$Total <- hw1_score$Score / 15 * 1.5 -->


<!-- hw1_score$Exam <- round(hw1_score$Total, 1) -->



<!-- hw1_score_print <- hw1_score %>% select(-Total) -->

<!-- kable(hw1_score_print, col.names = c("Login", "Score", "Exam")) -->


<!-- ``` -->




<!-- ## **Анализ самостоятельной работы № 2** -->

<!-- Максимальное количество баллов для экзамена 1.5% -->





<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE, eval=FALSE} -->

<!-- hw2 <- read_excel("data/Самостоятельная работа № 2 (Общая экология 2021) (Общая экология 2022)(1-78).xlsx") -->

<!-- hw2_score <- hw2 -->

<!-- names(hw2_score) <- c("St_Mail","Name", "Score") -->


<!-- hw2_score <- merge(class, hw2_score) %>% select(-c(St_Mail, Name)) -->


<!-- hw2_score$Total <- hw2_score$Score / 21 * 1.5 -->


<!-- hw2_score$Exam <- round(hw2_score$Total, 1) -->



<!-- hw2_score_print <- hw2_score %>% select(-Total) -->

<!-- kable(hw2_score_print, col.names = c("Login", "Score", "Exam")) -->


<!-- ``` -->



## **Оценки за семинары**

Максимальное количество баллов для экзамена 16%

<!-- ```{r warning = FALSE, eval=FALSE} -->

<!-- sem <- read_excel("data/Семинары по экологии биотехнологи 2022.xlsx", na = "NA") -->

<!-- sem <- sem %>% select(Login, Seminar_1, Seminar_2) -->

<!-- sem_print <- merge(class, sem) %>% select(Login, Group, Seminar_1, Seminar_2) %>% rowwise() %>% mutate(Exam = sum(Seminar_1 * 8,  Seminar_2 * 8, na.rm = T) ) -->

<!-- ``` -->

<!-- ```{r eval=FALSE} -->
<!-- kable(sem_print) -->


<!-- ``` -->





<!-- ## **Семинар-конференция № 2** -->


<!-- ```{r} -->

<!-- sem_2 <- read_excel("data/Conference_seminar_2.xlsx") -->

<!-- sem_2_print <- merge(class, sem_2) %>% select(-St_Mail) %>% mutate(Exam = Presentation + Presence + Speech + Bonus) -->

<!-- ``` -->

<!-- ```{r} -->
<!-- kable(sem_2_print) -->

<!-- ``` -->



<!-- ## **Результаты семинаров** -->

<!-- Семинары приносят в экзаменационную оценку 27% -->

<!-- **Коллеги!** -->

<!-- Оценки, которые вы видите ниже, это результат автоматической обработки базы, которую заполняют преподаватели после семинаров.  Проверяйте, пожалуйста, все ваши текущие оценки. Если вы видите, что вам что-то не проставлено, то срочно связывайтесь с соответствующим преподавателем. -->

<!-- Поверьте, у нас колоссальная нагрузка и мы не всегда успеваем внести оценки в ведомость. Контролируйте этот процесс, пожалуйста. -->



<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE, eval=FALSE} -->

<!-- seminars <- read_excel("data/Семинары биологи 2022.xlsx") -->

<!-- names(seminars)[1:3] <- c( "Family", "Name", "Login") -->

<!-- seminars_print <- seminars %>% select(-Family, -Name) -->



<!-- seminars_print$Exam <- seminars_print %>% select(- c(Login, Group) ) %>% mutate(Sum = rowSums(., na.rm = T), Exam = Sum) %>% pull(Exam)  -->

<!-- seminars_print$Exam <- seminars_print$Exam*3 -->

<!-- kable(seminars_print) -->


<!-- ``` -->







## **Итоговый счет группа биоинженеров**


<!-- ```{r warning = FALSE} -->

<!-- tests <- credits_print %>% select(Login, Exam) -->

<!-- cont1 <- cont1_print %>% select(Login, Exam) -->

<!-- cont2 <- cont2_print %>% select(Login, Exam) -->

<!-- sems <- sem_print %>% select(Login, Exam) -->

<!-- d <- merge(tests, cont1, by = "Login") -->
<!-- dd <- merge(d, cont2, by = "Login") -->
<!-- final <- merge(dd, sems, by = "Login") -->

<!-- names(final) <- c("Login", "Тесты по лекциям", "Контрольная 1", "Контрольная 2","Семинары" ) -->

<!-- Exam <- rowSums(final[,-1], na.rm = T) -->

<!-- final$Exam <- Exam -->

<!-- kable(final) -->

<!-- ``` -->



<!-- ## **Итоговый счет биологи 2022** -->



<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE} -->
<!-- library(stringr) -->


<!-- d1 <- credits_print %>% select(Login, Exam) -->
<!-- d1$Exam <- round(d1$Exam, 2) -->


<!-- d2 <- cont1_print %>% select(Login, Exam) -->
<!-- d2$Exam <- round(d2$Exam, 2) -->



<!-- d3 <- cont2_print %>% select(Login, Exam) -->
<!-- d3$Exam <- round(d3$Exam, 2) -->


<!-- d4 <- hw1_score_print %>% select(Login, Exam) -->
<!-- d4$Login <- word(d4$Login, 1 ,sep = "\\@") -->
<!-- d4$Exam <- round(d4$Exam, 2) -->


<!-- d5 <- hw2_score_print %>% select(Login, Exam) -->
<!-- d5$Login <- word(d5$Login, 1 ,sep = "\\@") -->
<!-- d5$Exam <- round(d5$Exam, 2) -->


<!-- d6 <- seminars_print %>% select(Login, Exam) -->
<!-- d6$Exam <- round(d6$Exam, 2) -->


<!-- Results <- merge(d1, d2, by = "Login", all = T) %>% merge(., d3, by = "Login", all = T) %>% merge(., d4, by = "Login", all = T) %>%  merge(., d5, by = "Login", all = T) %>%  merge(., d6, by = "Login", all = T) -->


<!-- names(Results) <- c("Login", "Lecture_test (max 3)", "Control_1(max 1.5)", "Control_2 (max 1.5)", "Home Work 1 (max 1.5)", "Home Work 2 (max 1.5)", "Seminars (max 21)") -->


<!-- Results_print <- Results -->

<!-- Results_print$Exam <- round(apply(Results[,-1], MARGIN = 1, FUN = function(x) sum(x, na.rm = T) ), 1) -->

<!-- Results_print <- Results_print %>% filter(!is.na(Login)) %>% filter(Login != "NA") -->




<!-- # # Код для вывода суммарных оценок с именами. -->
<!-- # class <- read_xlsx("data/Classess_2022_biology.xlsx", col_names = T) -->
<!-- #  -->
<!-- # final_results <- class %>% select(Family, Name, Otch, Login) %>% merge(., Results_print, all.x = T)  -->
<!-- #  -->
<!-- # write.table(final_results, "clipboard", sep = "\t", row.names = F) -->

<!-- ``` -->

<!-- ```{r} -->

<!-- options(knitr.kable.NA = '-') -->
<!-- kable(Results_print) -->
<!-- ``` -->


<!-- ```{r} -->
<!-- # Результаты в сумме для создания файла-ведомости экзамена -->

<!-- class <- read_xlsx("data/Classess_2022_biology.xlsx", col_names = T) -->
<!-- # class <- class %>% filter(!is.na(Login)|!is.na(Group) ) -->
<!-- class <- class %>% select(St_Mail, Login, Family, Name, Otch ) -->
<!-- res <- merge(class, Results_print) -->

<!-- write.table(res, "data/results_for_examen.csv", sep = ";", row.names = F, fileEncoding = "UTF-8", dec = "," ) -->

<!-- ``` -->



