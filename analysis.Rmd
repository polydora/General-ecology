---
title: Анализ работы
---

<!-- Здесь будут выкладываться текущие результаты ваших работ. -->




```{r,  echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(dplyr)
library(readxl)
library(ggplot2)
library(broom)
library(tidyr)


class <- read_xlsx("data/Classess_2021_biology.xlsx", col_names = T)
# class <- class %>% filter(!is.na(Login)|!is.na(Group) )
class <- class %>% select(St_Mail, Login)


opts_chunk$set(echo = FALSE)
# class[class$Login == "st092164", ]


# class[is.na(class$St_Mail),]
```



# **Анализ тестов по материалам лекций**

```{r,  echo=FALSE, message=FALSE, warning=FALSE}

credits <- class %>% select(Login, St_Mail)

# credits[credits$Login == "st092164", ]
# credits[credits$Login == "st092135", ]

# Тест по Лекции 1
test_lecture_1 <- read_excel("data/Основы ОТС и Предмет экологии  (Общая экология 2021)(1-106).xlsx")
test_lecture_1 <- test_lecture_1 %>% select(c(1,3))

# test_lecture_1 <- read_xlsx("data/Суть экологии. Теория систем. Живые системы.  (Общая экология для Биотехнологов)(1-28).xlsx")

names(test_lecture_1) <- c("St_Mail", "Score_lecture_1")

# test_lecture_1[test_lecture_1$St_Mail == "st092164@student.spbu.ru", ]


credits <- merge(credits, test_lecture_1, all.x = TRUE)

# credits[credits$St_Mail == "st092164@student.spbu.ru", ]


# add_score <- data.frame(St_Mail = "st078729@student.spbu.ru", Addition = 1)

# credits <- merge(credits, add_score, by.x = "St_Mail", all.x = TRUE)



#Тест по Лекции 2

# test_lecture_2 <- read_xlsx("data/Аутэкология (биотехнологи). (Общая экология для Биотехнологов)(1-26).xlsx")

test_lecture_2 <- read_xlsx("data/Аутэкология (Общая экология 2021)(1-98).xlsx")




test_lecture_2 <- test_lecture_2 %>% select(1,2)
names(test_lecture_2) <- c("St_Mail", "Score_lecture_2")

credits <- merge(credits, test_lecture_2, all.x = TRUE)



#Тест по Лекции 3_4
# test_lecture_3 <- read_xlsx("data/Демэкология. Структура популяции. (Общая экология для Биотехнологов)(1-26).xlsx")

test_lecture_3 <- read_xlsx("data/Структура и динамика популяций  (Общая экология 2021)(1-87).xlsx")


test_lecture_3 <- test_lecture_3 %>% select(1,2)
names(test_lecture_3) <- c("St_Mail", "Score_lecture_3")

credits <- merge(credits, test_lecture_3, all.x = TRUE)

# credits$Addition_2 <- 1

# 
# #Тест по Лекции 4
# test_lecture_4 <- read_xlsx("data/Динамика популяции (биотехнологи) (Общая экология для Биотехнологов)(1-27).xlsx")
# test_lecture_4 <- test_lecture_4 %>% select(1,2)
# names(test_lecture_4) <- c("St_Mail", "Score_lecture_4")
# 
# credits <- merge(credits, test_lecture_4, all.x = TRUE)
# 
# 

#Тест по Лекции 5-6

test_lecture_5 <- read_xlsx("data/Взаимоотношения организмов (Общая экология 2021)(1-79).xlsx")
test_lecture_5 <- test_lecture_5 %>% select(1,2)
names(test_lecture_5) <- c("St_Mail", "Score_lecture_5")

credits <- merge(credits, test_lecture_5, all.x = TRUE)


#Тест по Лекции 7-8
# test_lecture_6 <- read_xlsx("data/Конкуренция (биотехнологи) (Общая экология для Биотехнологов)(1-24).xlsx")

test_lecture_6 <- read_xlsx("data/Конкуренция и трофические связи (Общая экология 2021)(1-85).xlsx")


test_lecture_6 <- test_lecture_6 %>% select(1,2)
names(test_lecture_6) <- c("St_Mail", "Score_lecture_6")

credits <- merge(credits, test_lecture_6, all.x = TRUE)



#Тест по Лекции 9-10
# test_lecture_7 <- read_xlsx("data/Трофические связи (биотехнологи) (Общая экология для Биотехнологов)(1-27).xlsx")

test_lecture_7 <- read_xlsx("data/Симбиозы и структура сообществ (Общая экология 2021)(1-73).xlsx")

test_lecture_7 <- test_lecture_7 %>% select(1,3)
names(test_lecture_7) <- c("St_Mail", "Score_lecture_7")

credits <- merge(credits, test_lecture_7, all.x = TRUE)





#Вывод общей таблицы с баллами

credits_sum <- 10 + 10 + 19 + 9 + 14 + 9
# + 10 + 10 + 10 + 10 + 10 + 8

credits_print <- credits %>% select(-St_Mail)

credits_print$Sum <- credits_print %>% select(-c("Login")) %>% rowSums(na.rm=TRUE)

credits_print$Credit_Sum <- credits_sum

credits_print$Exam <- credits_print$Sum / credits_print$Credit_Sum

# credits_print$Exam <- round(credits_print$Exam, 1) * 10 #умножаем на это число, так как от каждой из 8 лекций приходит 10/8 финальной оценки


```

**Состояние индивидуального счета студентов**

```{r, echo=F}

options(knitr.kable.NA = '-')
kable(credits_print)

```










<!-- <!-- **Внимание**    --> 
<!-- <!-- В графе *"Proportion_of_final"* Публикуется текущее количество набранных баллов, которое войдет в финальную оценку. Однако, эта величина будет изменяться, так как общее количество баллов, которое приводится в графе *"Credit_Sum"*, тоже будет изменяться по мере открытия новых заданий.  --> 

<!-- Следите за текущим счетом и если что-то не так, то пишите. -->


<!-- <br> -->
<!-- <br> -->




# **Анализ отчетов по самостоятельной работе № 1**


```{r,  echo=FALSE, message=FALSE, warning=FALSE}

hw1 <- read_xlsx("data/Тест по самостоятельной работе №1 (Общая экология 2021)(1-108).xlsx")
hw1 <- hw1[1:2]
names(hw1) <- c("Login", "Score")

hw1 <- hw1 %>% group_by(Login) %>% summarise(Score = max(Score))

# add_hw1 <- read.csv("data/Самостоятельная работа №1 Дополнительный вопрос.csv", header = T)
# names(add_hw1) <- c("Login", "add_score")
# 
# add_hw1 <- add_hw1 %>% group_by(Login) %>% summarise(add_score = max(add_score))
# 
# # hw1[!(hw1$Login %in% add_hw1$Login), ]
# 

# hw1_score <- class %>% select(St_Mail, Login)
# 
# hw1_score <- merge(hw1_score, hw1, all.x = T)
# 
# hw1_score <- merge(hw1_score, add_hw1, all.x = T)
# 
# hw1_score$Sum <- hw1_score %>% select(Score, add_score) %>% rowSums(., na.rm = T)

hw1_score <- hw1

hw1_score$Total <- 15

hw1_score$Exam <- round(hw1_score$Score / hw1_score$Total, 1)

# hw1_score_print <- hw1_score %>% select(Login, Score, add_score, Sum, Exam)

hw1_score_print <- hw1_score 

# kable(hw1_score_print, col.names = c("Login", "Основные вопросы", "Доп. вопр. 1", "Сумма",  "% от экзаменационной оценки"))

kable(hw1_score_print, col.names = c("Login", "Сумма", "Всего вопросов",  "% от экзаменационной оценки"))


```

<br>
<br>


# **Анализ отчетов по самостоятельной работе № 2**


```{r,  echo=FALSE, message=FALSE, warning=FALSE}

hw2 <- read_xlsx("data/Самостоятельная работа № 2 (Общая экология 2021)(1-89).xlsx")
hw2 <- hw2 %>% select(1, 3)
names(hw2) <- c("Login", "Score")


# add_hw1 <- read.csv("data/Самостоятельная работа №1 Дополнительный вопрос.csv", header = T)
# names(add_hw1) <- c("Login", "add_score")
# 
# add_hw1 <- add_hw1 %>% group_by(Login) %>% summarise(add_score = max(add_score))
# 
# # hw1[!(hw1$Login %in% add_hw1$Login), ]
# 

# hw1_score <- class %>% select(St_Mail, Login)
# 
# hw1_score <- merge(hw1_score, hw1, all.x = T)
# 
# hw1_score <- merge(hw1_score, add_hw1, all.x = T)
# 
# hw1_score$Sum <- hw1_score %>% select(Score, add_score) %>% rowSums(., na.rm = T)

hw2_score <- hw2

hw2_score$Total <- 18

hw2_score$Exam <- round(hw2_score$Score / hw2_score$Total, 1)

# hw1_score_print <- hw1_score %>% select(Login, Score, add_score, Sum, Exam)

hw2_score_print <- hw2_score 

# kable(hw1_score_print, col.names = c("Login", "Основные вопросы", "Доп. вопр. 1", "Сумма",  "% от экзаменационной оценки"))

kable(hw2_score_print, col.names = c("Login", "Сумма", "Всего вопросов",  "% от экзаменационной оценки"))


```

<!-- <br> -->
<!-- <br> -->




<!-- # **Анализ отчетов по самостоятельной работе № 2** -->



<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE} -->

<!-- hw2 <- read_excel("data/Репродукция и жизненные циклы организмов (Основные вопросы).xlsx") -->


<!-- add_hw2 <- read_excel("data/Репродукция и жизненные циклы организмов (Дополнительный вопрос)_оценено_2.xlsx") -->
<!-- add_hw2 <-  add_hw2 %>% select(-Timestamp) -->

<!-- names(add_hw2) <- c("Login", "add_score_2", "add_score_3") -->


<!-- hw2_score <- merge(hw2, add_hw2, all.x = T) -->

<!-- hw2_score <- hw2_score %>% group_by(Login) %>% summarise(Score = max(Score), Add_1 = max(Add_1), add_score_2 = max(add_score_2), add_score_3 = max(add_score_3) ) -->

<!-- hw2_score$Sum <- hw2_score %>% select(Score, Add_1, add_score_2, add_score_3) %>% rowSums(na.rm = T) -->

<!-- hw2_score$Total <- hw2_score$Sum / 15  -->


<!-- hw2_score$Exam <- round(hw2_score$Total, 1)   -->



<!-- hw2_score_print <- hw2_score  -->

<!-- kable(hw2_score_print, col.names = c("Login", "Основные вопросы", "Доп. вопр. 1", "Доп. вопр. 2", "Баллы за придуманные вопросы", "Сумма", "Доля от максимума", "% от экзаменационной оценки")) -->


<!-- ``` -->


<!-- **Господа!** Все большие молодцы, но не могу удержаться от замечания. --> 

<!-- В научном аду за **плагиат**  в костер кладут ОЧЕНЬ большое бревно!  --> 

<!-- <!-- К сожалению, при проверке СР-2 было обнаружено несколько практически идентичных ответов за дополнительный вопрос №2. Мы поставили одинаковые оценки за этот вопрос всем, кто прислал идентичные ответы, поскольку мы не хотели выяснять, кто истинный автор. **НО, пожалуйста, больше так не делайте!**  -->

<!-- <br> -->
<!-- <br> -->


<!-- # **Анализ отчетов по самостоятельной работе № 3** -->



<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE} -->

<!-- hw3 <- read_excel("data/Самостоятельная работа № 3.xlsx", na = "NA") -->


<!-- names(hw3) <- c("Score", "Login") -->


<!-- hw3_score <- hw3 %>% group_by(Login) %>% summarise(Score = max(Score)) -->

<!-- hw3_score$Sum <- hw3_score %>% select(Score) %>% rowSums(na.rm = T) -->

<!-- hw3_score$Total <- hw3_score$Sum / 40  -->


<!-- hw3_score$Exam <- round(hw3_score$Total, 1)   -->

<!-- hw3_score <- hw3_score[!is.na(hw3_score$Login), ] -->


<!-- hw3_score_print <- merge(class[, "Login"], hw3_score, all.x = TRUE )  -->

<!-- kable(hw3_score_print, col.names = c("Login", "Основные вопросы", "Сумма", "Доля от максимума", "% от экзаменационной оценки")) -->


<!-- ``` -->


<!-- **Господа!** Приношу извинения за задержку с публикацией оценок. Напоминаю, что баллы за эту работу дополнительные (те, кто работу не сделал, ничего не потерял... но и не приобрел:). Поскольку в результате высвободился 1%, он уходит в оценку за работы по тестам по материалам лекций (то есть вес этой оценки удваивается). -->



<!-- <br> -->
<!-- <br> -->


## **Анализ контрольной работы № 1**


```{r,  echo=FALSE, message=FALSE, warning=FALSE}

# cont1 <- read_excel("data/Control_work_1_biotech.xlsx")

cont1 <- read_excel("data/Контрольная работа № 1 (Общая экология 2021)(1-99).xlsx")
names(cont1) <- c("St_Mail", "Score", "Name") 

cont1_print <- merge(class, cont1 %>% select(-Name ) ) %>% select(-St_Mail) %>% mutate(Exam = Score / 24)

# correl <- tidy(cor.test(cont1$Incorrect, cont1$Time))

#  cont_reg[!(cont_reg$Login %in% cont$Login), ]

# table(cont_reg$Login)
#
#
# cont1 <- cont %>% group_by(Login) %>% summarise(Score = max(Score))
#
# cont1$Add <- 1
#
# cont1$Total <- (cont1$Score + cont1$Add)/18
#
# cont1$Exam <- round(cont1$Total * 2.5, 1)
#
# cont1_print <- class %>% select(Login)
#
# cont1_print <- merge(cont1_print, cont1, all.x = T)

kable(cont1_print)


```
Вот люди, которые абсолютно правильно ответили на каверзный вопрос про сумму эффективных температур.

Камил-Джан Байазыт
Ксения Давыдова
Валерия Иштуганова
Арсений Шкляр
Георгий Данелия
Екатерина Кандаловская

В этом вопросе не было ни одного правильного ответа! Надо было просто не отвечать на него. Более того, цифры были подобраны таким образом, чтобы получался нереалистичный результат. Развитие ни одного из растений не может начинаться при температуре -35 градусов. 


<!-- ## **Семинар-конференция № 1** -->


<!-- ```{r} -->

<!-- sem_1 <- read_excel("data/Conference_seminar_1.xlsx") -->

<!-- sem_1_print <- merge(class, sem_1) %>% select(-St_Mail) %>% mutate(Exam = Presentation + Presence + Speech + Bonus) -->

<!-- ``` -->

<!-- ```{r} -->
<!-- kable(sem_1_print) -->


<!-- ``` -->


## **Анализ контрольной работы № 2**


```{r,  echo=FALSE, message=FALSE, warning=FALSE}

# cont1 <- read_excel("data/Control_work_1_biotech.xlsx")

cont2 <- read_excel("data/Контрольная работа № 2 (Общая экология 2021)(1-11).xlsx")
names(cont2) <- c("St_Mail",  "Name", "Score") 

cont2_print <- merge(class, cont2 %>% select(-Name ) ) %>% select(-St_Mail) %>% mutate(Exam = Score / 14)

kable(cont2_print)

```

<!-- ## **Семинар-конференция № 2** -->


<!-- ```{r} -->

<!-- sem_2 <- read_excel("data/Conference_seminar_2.xlsx") -->

<!-- sem_2_print <- merge(class, sem_2) %>% select(-St_Mail) %>% mutate(Exam = Presentation + Presence + Speech + Bonus) -->

<!-- ``` -->

<!-- ```{r} -->
<!-- kable(sem_2_print) -->

<!-- ``` -->



## **Результаты семинаров**

**Коллеги!**

Оценки, которые вы видите ниже, это результат автоматической обработки базы, которую заполняют преподаватели после семинаров.  Проверяйте, пожалуйста, все ваши текущие оценки. Если вы видите, что вам что-то не проставлено, то срочно связывайтесь с соответствующим преподавателем. 

Поверьте, у нас колоссальная нагрузка (особенно теперь...) и мы не всегда успеваем внести оценки в ведомость. Контролируйте этот процесс, пожалуйста.  



```{r}
seminars <- read_excel("data/Семинары по общей экологии (биологи) 2021.xlsx")

names(seminars)[1:3] <- c( "Family", "Name", "St_Mail") 

seminars_print <- merge(class, seminars)

seminars_print <- seminars_print %>% select(-St_Mail, -Family, -Name) %>% arrange((Login))


seminars_print$Exam <- seminars_print %>% select(- c(Login, Group) ) %>% mutate(Sum = rowSums(., na.rm = T), Exam = Sum) %>% pull(Exam)


kable(seminars_print)


```







## **Итоговый счет**


```{r,  echo=FALSE, message=FALSE, warning=FALSE}
library(stringr)


d1 <- credits_print %>% select(Login, Exam)
d1$Exam <- round(d1$Exam*3, 2)


d2 <- cont1_print %>% select(Login, Exam)
d2$Exam <- round(d2$Exam * 1.5, 2)



d3 <- cont2_print %>% select(Login, Exam)
d3$Exam <- round(d3$Exam * 1.5, 2)


d4 <- hw1_score_print %>% select(Login, Exam)
d4$Login <- word(d4$Login, 1 ,sep = "\\@")
d4$Exam <- round(d4$Exam * 1.5, 2)


d5 <- hw2_score_print %>% select(Login, Exam)
d5$Login <- word(d5$Login, 1 ,sep = "\\@")
d5$Exam <- round(d5$Exam * 1.5, 2)


d6 <- seminars_print %>% select(Login, Exam)
d6$Exam <- round(d6$Exam * 3, 2)


Results <- merge(d1, d2, by = "Login", all = T) %>% merge(., d3, by = "Login", all = T) %>% merge(., d4, by = "Login", all = T) %>%  merge(., d5, by = "Login", all = T) %>%  merge(., d6, by = "Login", all = T)


names(Results) <- c("Login", "Lecture_test (max 3)", "Control_1(max 1.5)", "Control_2 (max 1.5)", "Home Work 1 (max 1.5)", "Home Work 2 (max 1.5)", "Seminars (max 21)")


Results_print <- Results

Results_print$Exam <- round(apply(Results[,-1], MARGIN = 1, FUN = function(x) sum(x, na.rm = T) ), 1)


```

```{r}
kable(Results_print)
```


<!-- ```{r} -->
<!-- class2 <- read_xlsx("data/Classess_2021_biotech.xlsx", col_names = T) -->

<!-- merge(class2, Results_print) %>% select(Family,Name,Login, Exam) %>% write.csv(.,"before_exam_2021_biotech.csv") -->
<!-- ``` -->

<!-- ## **Анализ контрольной работы № 2** -->

<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE} -->
<!-- #  -->
<!-- # cont_reg2 <- read_excel("data/Регистрационная форма для выполнения контрольной работы № 1 (Responses).xlsx") -->

<!-- cont <- read_excel("data/Контрольная работа №2 (Responses).xlsx") -->

<!-- # cont_reg[!(cont_reg$Login %in% cont$Login), ] -->

<!-- # table(cont_reg$Login) -->


<!-- cont2 <- cont %>% group_by(Login) %>% summarise(Score = max(Score)) -->


<!-- # cont2$Add <- 0 -->

<!-- cont2$Total <- (cont2$Score)/18 -->

<!-- cont2$Exam <- round(cont2$Total * 2.5, 1)   -->

<!-- cont2_print <- class %>% select(Login) -->

<!-- cont2_print <- merge(cont2_print, cont2, all.x = T) -->

<!-- kable(cont2_print) -->

<!-- ``` -->



<!-- ## **Частотное распределение результатов** -->


<!-- ```{r,  echo=FALSE, message=FALSE, warning=FALSE} -->
<!-- library(ggplot2) -->
<!-- library(patchwork) -->

<!-- Pl_lect <- ggplot(credits_print, aes(x = Exam)) + stat_count(geom = "col") + labs(x = "% от экзаменационной оценки") + ggtitle("Тесты по материалам лекций")+xlim(0, 1) -->

<!-- Pl_hw1 <- ggplot(hw1_score, aes(x = Exam)) + stat_count(geom = "col") + labs(x = "% от экзаменационной оценки") + ggtitle("Самостоятельная работа №1")+xlim(0, 1) -->


<!-- Pl_cw1 <- ggplot(cont1, aes(x = Exam)) + stat_count(geom = "col") + labs(x = "% от экзаменационной оценки") + ggtitle("Контрольная работа №1")+xlim(0, 2.5) -->

<!-- Pl_hw2 <- ggplot(hw2_score, aes(x = Exam)) + stat_count(geom = "col") + labs(x = "% от экзаменационной оценки") + ggtitle("Самостоятельная работа №2")+xlim(0, 1) -->

<!-- Pl_hw3 <- ggplot(hw3_score, aes(x = Exam)) + stat_count(geom = "col") + labs(x = "% от экзаменационной оценки") + ggtitle("Самостоятельная работа №3")+xlim(0, 1) -->

<!-- Pl_cw2 <- ggplot(cont2, aes(x = Exam)) + stat_count(geom = "col") + labs(x = "% от экзаменационной оценки") + ggtitle("Контрольная работа №2") + xlim(0, 2.5) -->

<!-- (Pl_lect + Pl_hw1 + Pl_hw2 )/(Pl_hw3 + Pl_cw1 + Pl_cw2 ) -->

<!-- ``` -->


<!-- ## **Результаты семинаров** -->

<!-- **Внимание!** -->

<!-- ```{r} -->
<!-- seminars <- read.csv("data/Семинары по общей экологии - Sheet1.csv", header = TRUE) -->
<!-- Groups <- seminars %>% select(c(Group)) -->

<!-- seminars <- seminars %>% select(-c(Family, Name, Group)) -->

<!-- seminars$Sum <- rowSums(seminars[, 2:9], na.rm = T) -->


<!-- seminars$Exam <- seminars$Sum * 3 -->

<!-- Groups$Exam <-seminars$Exam  -->
<!-- ``` -->


<!-- ```{r} -->
<!-- kable(seminars) -->
<!-- ``` -->

<!-- ### **"Групповой зачет"** -->

<!-- Этот график иллюстрирует общую активность группы (ну или строгость преподавателя...) -->

<!-- ```{r} -->
<!-- ggplot(Groups, aes(x = factor(Group), y = Exam)) + geom_violin() + labs(x = "Группа")  -->
<!-- ``` -->

<!-- # **Финальный счет** -->

<!-- ```{r, message=FALSE} -->

<!-- tests <- credits_print %>% select(Login, Exam)  -->

<!-- hw1 <- hw1_score_print %>% select(Login, Exam)  -->

<!-- hw2 <- hw2_score_print %>% select(Login, Exam)  -->

<!-- hw3 <- hw3_score_print %>% select(Login, Exam)  -->

<!-- cont1 <- cont1_print %>%  select(Login, Exam) -->

<!-- cont2 <- cont2_print %>%  select(Login, Exam) -->

<!-- seminars <- seminars %>%  select(Login, Exam) -->


<!-- Total <- rbind(tests, hw1, hw2, hw3, cont1, cont2, seminars) -->

<!-- Result <-Total %>% group_by(Login) %>% summarize(Total = sum(Exam, na.rm = TRUE)) -->

<!-- kable(Result) -->
<!-- ``` -->

